<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="content-type" content="text/html" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="title" content="Cybersecurity Innovation Coverage Calculator" />
    <meta name="description" content="Assess innovation coverage across cybersecurity domains and capabilities." />
    <meta name="author" content="Idan Pinto" />
    <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Cybersecurity Innovation Coverage Calculator</title>

    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/style.css" />
    <style>
      body {
        background-color: #121212;
        color: #f1f1f1;
        margin: 0;
        padding: 2rem;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      h1 {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 1rem;
      }
      h5 {
        font-size: 1.25rem;
        font-weight: bold;
        margin-top: 1rem;
      }
      h6 {
        font-size: 1rem;
      }
      label {
        font-size: 1.05rem;
        font-weight: 600;
        color: #ffffff;
      }
      .form-control, .form-control:focus, .form-range {
        background-color: #2a2a2a;
        color: #ffffff;
        border-color: #444;
      }
      select.form-control {
        width: 220px;
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      canvas {
        max-width: 720px;
        margin: 0 auto 2rem auto;
        display: block;
      }
      .score-box {
        text-align: center;
        margin: 1rem 0;
        font-size: 1.5rem;
        font-weight: bold;
      }
      .domain-slider {
        background: linear-gradient(to right, #a3a3a3 0%, #00c0ff 50%, #00ff9d 100%);
        border-radius: 10px;
        height: 10px;
        appearance: none;
        outline: none;
      }
      .domain-slider::-webkit-slider-thumb {
        appearance: none;
        height: 24px;
        width: 24px;
        background: #ffffff;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid #444;
      }
      .domain-label {
        font-weight: bold;
        margin-bottom: 0.25rem;
        color: #ffffff;
        font-size: 1.05rem;
      }
      .domain-status {
        margin-top: 0.25rem;
        font-size: 0.95rem;
        font-weight: 500;
      }
      .low-status { color: #ff4c4c; }
      .medium-status { color: #ffa500; }
      .high-status { color: #00e676; }
    </style>
  </head>

  <body>
    <main class="container">
      <section class="text-center">
        <h1>Cybersecurity Innovation Coverage Calculator</h1>
        <canvas class="riskChart" id="riskChart" height="300"></canvas>
        <div class="score-box">
          <span>Total Score: <span id="scoreValue">0</span></span>
        </div>
      </section>

      <div class="row justify-content-center">
        <section class="col-auto">
          <h5>Select Capability</h5>
          <select class="form-control" id="capabilitySelect" onchange="calculateInnovationScore()">
            <option value="0">Metadata</option>
            <option value="1">Events</option>
            <option value="2">Monitoring</option>
            <option value="3">Detection</option>
            <option value="4">Enrichment</option>
          </select>
        </section>
      </div>

      <div class="row mb-4 mt-4">
        <section class="col-12">
          <h5>Adjust Per-Domain Scores</h5>
          <div id="customScores" class="row gx-3 gy-3"></div>
        </section>
      </div>

      <div class="row justify-content-center">
        <section class="col-auto">
          <h6 class="IS">Innovation Coverage Score</h6>
          <div class="score-box" id="innovationScore">0</div>
        </section>
      </div>

      <footer class="text-center mt-4">
        <div>
          2025 Cybersecurity Innovation Coverage Calculator | Modified by Idan Pinto | Based on OWASP Risk Calculator by <a href="https://hackpuntes.com" target="_blank">Javier Olmedo</a> | Source on <a href="https://github.com/JavierOlmedo/OWASP-Calculator" target="_blank">Github</a>
        </div>
      </footer>
    </main>

    <script src="js/jquery.min.js"></script>
    <script src="js/Chart.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
      const securityDomains = [
        "Data Security", "Identity Security", "SaaS Security", "External Attack Surface",
        "Runtime Security", "API Security", "Threat Detection", "Incident Response",
        "Security Operations", "Intelligence", "Compliance", "Code Security"
      ];

      const capabilityLabels = ["Metadata", "Events", "Monitoring", "Detection", "Enrichment"];

      let domainScores = [
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1],
        [2, 2, 3, 2, 2, 2, 3, 3, 2, 2, 2, 2],
        [3, 3, 4, 3, 4, 3, 4, 4, 3, 3, 3, 3],
        [4, 4, 4, 4, 4, 4, 5, 5, 4, 4, 4, 4]
      ];

      let customScores = [...domainScores[0]];
      let currentCapabilityIndex = 0;

      const radarCtx = document.getElementById("riskChart").getContext("2d");
      const radarChart = new Chart(radarCtx, {
        type: 'radar',
        data: {
          labels: securityDomains,
          datasets: [{
            label: "Coverage Score",
            backgroundColor: "rgba(0, 255, 100, 0.2)",
            borderColor: "rgba(0, 255, 100, 1)",
            pointBackgroundColor: "rgba(0, 255, 100, 1)",
            data: customScores
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#ffffff' } }
          },
          scales: {
            r: {
              angleLines: { color: '#444' },
              grid: { color: '#444' },
              pointLabels: { color: '#ffffff', font: { size: 13 } },
              ticks: {
                beginAtZero: true,
                max: 5,
                color: '#ffffff'
              }
            }
          }
        }
      });

      function calculateInnovationScore() {
        currentCapabilityIndex = parseInt(document.getElementById("capabilitySelect").value);
        customScores = [...domainScores[currentCapabilityIndex]];
        updateCustomSliders();
        updateChart();
      }

      function updateCustomSliders() {
        const container = document.getElementById("customScores");
        container.innerHTML = "";
        securityDomains.forEach((domain, i) => {
          const col = document.createElement("div");
          col.className = "col-md-3 mb-4";

          const label = document.createElement("label");
          label.className = "domain-label";
          label.innerText = domain;

          const input = document.createElement("input");
          input.type = "range";
          input.min = 0;
          input.max = 5;
          input.step = 1;
          input.value = customScores[i];
          input.className = "domain-slider w-100";
          input.oninput = function () {
            customScores[i] = parseInt(this.value);
            updateChart();
            statusSpan.innerText = getStatusLabel(this.value, currentCapabilityIndex);
            statusSpan.className = 'domain-status ' + getStatusClass(this.value);
          };

          const statusSpan = document.createElement("div");
          statusSpan.className = 'domain-status ' + getStatusClass(customScores[i]);
          statusSpan.innerText = getStatusLabel(customScores[i], currentCapabilityIndex);

          col.appendChild(label);
          col.appendChild(input);
          col.appendChild(statusSpan);
          container.appendChild(col);
        });
      }

      function getStatusLabel(score, capabilityIndex) {
        if (score === 0) return "Not Implemented";
        if (score === 1) return "Has Metadata Only";
        if (score === 2) return "Has Events";
        if (score === 3) return "Has Monitoring";
        if (score === 4) return "Includes Detection Logic";
        return "Fully Enriched + Correlated";
      }

      function getStatusClass(score) {
        if (score <= 1) return "low-status";
        if (score <= 3) return "medium-status";
        return "high-status";
      }

      function updateChart() {
        radarChart.data.datasets[0].data = customScores;
        radarChart.update();

        const total = customScores.reduce((sum, val) => sum + val, 0);
        document.getElementById("innovationScore").textContent = total;
        document.getElementById("scoreValue").textContent = total;
      }

      window.onload = () => {
        updateCustomSliders();
        updateChart();
      };
    </script>
  </body>
</html>
